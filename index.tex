\documentclass[degree=bachelor,tocarialchapter]{../thuthesis/thuthesis}
\usepackage{./thuthesis/thuthesis}
\usepackage{./thuappendixbib/thuappendixbib}
\usepackage{subfiles}
\usepackage{siunitx}
\usepackage{cleveref}
\thusetup{%
  ctitle={电动汽车无线充电系统\\磁谐振部件优化设计软件研究},
  etitle={Optimal design for magnetic resonant components of EV wireless charging system},
  cauthor={涂金正},
  eauthor={Tu, Jinzheng},
  cdegree={工学学士},
  edegree={Bachelor of Engineering},
  cdepartment={电机工程与应用电子技术系},
  edepartment={Department of Electrical Engineering},
  cmajor={电气工程及其自动化},
  emajor={Electrical Engineering},
  csupervisor={陈凯楠~助理研究员},
  esupervisor={Chen, Kainan Assistant Professor},
}
\sisetup{binary-units=true,list-separator={, },list-final-separator={, },list-pair-separator={, },separate-uncertainty,range-phrase={\ensuremath{\sim}}}
\newcommand\crefpairgroupconjunction{和}\newcommand\crefmiddlegroupconjunction{、}\newcommand\creflastgroupconjunction{和}
\newcommand\crefrangeconjunction{至}\newcommand\crefrangepreconjunction{}\newcommand\crefrangepostconjunction{}
\newcommand\crefpairconjunction{和}\newcommand\crefmiddleconjunction{、}\newcommand\creflastconjunction{和}
\crefname{appendix}{附录}{附录}\Crefname{appendix}{附录}{附录}
\crefname{listing}{程序}{程序}\Crefname{listing}{程序}{程序}
\crefname{equation}{式}{式}\Crefname{equation}{式}{式}
\crefformat{chapter}{第#1章}\Crefformat{chapter}{第#1章}
\crefname{section}{节}{节}\Crefname{section}{节}{节}
\crefname{subappendix}{节}{节}\Crefname{subappendix}{节}{节}
\crefname{subsubappendix}{节}{节}\Crefname{subsubappendix}{节}{节}
\crefname{subsubsubappendix}{节}{节}\Crefname{subsubsubappendix}{节}{节}
\crefname{figure}{图}{图}\Crefname{figure}{图}{图}
\crefname{table}{表}{表}\Crefname{table}{表}{表}
\AtBeginDocument{% ...if you're using hyperref
  \let\oldlabel\label% Copy original version of \label
  \let\oldref\ref% Copy original version of \ref
  \let\oldcref\cref% Copy original version of \cref
  \let\oldCref\Cref% Copy original version of \Cref
}
\newcommand{\addlabelprefix}[1]{%
  \renewcommand{\label}[1]{\oldlabel{#1-##1}}% Update \label
  \renewcommand{\ref}[1]{\oldref{#1-##1}}% Update \ref
}
\newcommand{\addlabelprefixc}[1]{%
  \renewcommand{\label}[1]{\oldlabel{#1-##1}}% Update \label
  \renewcommand{\cref}[1]{\oldcref{#1-##1}}% Update \cref
  \renewcommand{\Cref}[1]{\oldCref{#1-##1}}% Update \Cref
}
\newcommand{\removelabelprefix}{%
  \renewcommand{\label}{\oldlabel}% Restore \label
  \renewcommand{\ref}{\oldref}% Restore \ref
  \renewcommand{\cref}{\oldcref}% Restore \cref
  \renewcommand{\Cref}{\oldCref}% Restore \Cref
}
% For subfiles
\makeatletter%
\@ifclassloaded{subfiles}%
  {%\AtBeginDocument{\Denotation}
  \AtEndDocument{%
    \bibliographystyle{thuthesis-author-year}
    \bibliography{index}
  }}%
  {\relax}%
\makeatother%
\newcommand{\one}{{1}}
\let\oldPr\Pr
\renewcommand{\Pr}[1]{\oldPr\!\left[#1\right]}
\newcommand{\E}[1]{\operatorname{E}\!\left[#1\right]}
\newcommand{\Var}[1]{\operatorname{Var}\!\left[#1\right]}
\newcommand{\Cov}[2]{\operatorname{Cov}\!\left[#1,#2\right]}
\newcommand{\Corr}[2]{\operatorname{Corr}\!\left[#1,#2\right]}
\newcommand{\Normal}[2]{\operatorname{N}\!\left(#1,#2\right)}
\DeclareMathOperator*{\argmin}{argmin}
\DeclareMathOperator*{\argmax}{argmax}
\newcommand{\Denotation}[0]{%
\begin{denotation}
  \item[$\one_n$] $n\times{}1$的全1列向量
  \item[$\Pr{\cdot}$] 某事件发生的概率
  \item[$\E{\cdot}$] 随机变量的期望
  \item[$\Var{\cdot}$] 随机变量的方差
  \item[$\Cov{\cdot}{\cdot}$] 两个随机变量的协方差
  \item[$\Corr{\cdot}{\cdot}$] 两个随机变量的相关系数
  \item[$\beta$] 随机过程的均值
  \item[$\sigma^2$] 随机过程的方差
  \item[$\Normal{\mu}{\Sigma}$] （多元）正态分布
  \item[$n$] 已完成实验的数目
  \item[$x_s\quad x_i$] 已完成实验的位置（集合和元素）
  \item[$y_s\quad y_i$] 已完成实验的结果（集合和元素）
  \item[$p$] 进行中实验的数目
  \item[$x_\ast\quad x_{\ast i}$] 进行中实验的位置（集合和元素）
  \item[$x_\star$] 下一步应该进行的实验的位置
  \item[$Y(x)$] $x$处的实验结果对应的随机变量（先验）
  \item[$Y(x)|y_s$] $x$处的实验结果对应的随机变量（后验）
  \item[$K$] 已完成实验处对已完成实验处随机变量的归一化协方差矩阵
  \item[$K_s$] 未完成实验处\footnote{包括进行中实验和下一步应该进行的实验，下同}对已完成实验处随机变量的归一化协方差矩阵
  \item[$K_{ss}$] 未完成实验处对未完成实验处随机变量的归一化协方差矩阵
\end{denotation}
}

\begin{document}
\frontmatter

\begin{cabstract}
  摘要
\end{cabstract}
\ckeywords{关键词}

\begin{eabstract}
  Abstract
\end{eabstract}
\ekeywords{Keyword}

\makecover

\tableofcontents

\Denotation

\mainmatter

\subfile{introduction}
\subfile{features}
\subfile{doebgo}
\subfile{petri}
\subfile{design}
\subfile{impl}
\subfile{example}
\subfile{conclusion}

\backmatter

\listoffigures
\listoftables
\listofequations

\bibliographystyle{thuthesis-numeric}
\bibliography{index}

\begin{acknowledgement}
  致谢
\end{acknowledgement}

\begin{appendix}
\addlabelprefixc{trans}
\subfile{trans}
\removelabelprefix
\addlabelprefix{raw}
\subfile{raw}
\removelabelprefix
\end{appendix}

\end{document}
